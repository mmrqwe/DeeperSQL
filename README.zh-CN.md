# DeeperSQL 软件详细教程
## 语言更改
[English](README.md)

## 教程目录
* 1. 软件简介
* 2. 安装与启动
* 3. 主要功能
* 4. 操作步骤
* 5. 常见问题
* 6. 联系与支持

## 1. 软件简介
DeeperSQL 是一款集成Excel智能交互、知识图谱构建、AI问答、数据可视化等多功能于一体的工具软件，适用于数据编辑与分析、知识管理、智能问答等多种场景。
* 导入Excel文件后，可通过自然语言处理并导出。
* 内置图表组件，可对数据进行可视化分析
* 可以通过大语言模型构建知识图谱，并进行智能问答
* 跨平台支持（Windows/macOS）

## 2. 安装与启动
### 2.1 环境要求
* 操作系统：Windows 10/11 或 macOS
* 依赖：.NET 8.0 及以上
### 2.2 安装步骤
1. 下载最新安装包。
2. 确保.NET组件支持，同时具备在线/离线大模型支持。(自带嵌入式模型)
3. 运行 `DeeperSQL` 主程序。
### 2.3 启动软件
1. 双击可执行文件。
2. 首次启动请配置好大语言模型相关设置，以保证软件正确运行。

## 3. 主要功能
### 3.1 Excel智能交互
导入Excel文件后，可将其保存至数据库中，可通过自然语言进行智能处理、分析并导出。
### 3.2 知识图谱
支持知识图谱的节点、关系、社区的自动生成、查看、查询，软件通过大语言模型自动生成知识图谱。
### 3.3 AI问答
AI问答模块支持多种大语言模型的接入，用户可通过自然语言进行智能问答，可选择已生成的知识图谱进行问答。
### 3.4 数据分析
导入的Excel文件入库后可进行数据分析、可视化。
### 3.5 API服务
对SQL智能交互提供API服务。

## 4. 操作步骤
### 4.1 设置
1. 主界面点击设置，选择“Setting”。
2. 弹出设置界面后，点击大模型（LLM）选项卡，选择常用模型提供商，再填入API地址，如果有API密钥则填入，再选择对应模型。
3. 填入合适的每分钟调用次数限制和令牌（token）限制，一般在线API限制较低（10-30），令牌限制要大于等于4096，一般小于10240（根据实际情况调整）。
4. 再填入嵌入模型的API地址和API密钥，选择对应模型。如果本地模型填入localhost无反应则可尝试127.0.0.1。
5. 如果模型加载有问题会弹窗，请务必保障模型正确加载。
6. 如果勾选“SQL请求使用示例数据”，会将数据库表中第一行数据作为示例数据，如果涉及隐私或保密安全，请使用本地LLM或不勾选。
7. 如果勾选“使用原文索引”，会增加令牌使用量，但同时检索更准确。
### 4.2 创建知识图谱
1. 主界面点击知识库，选择子项知识库。
2. 在知识库界面左边树形控件中选择节点，并点击右键。
3. 弹出选择框后点击添加组，并填入该组名称，并点击确认。
4. 添加完成后，在属性控件中点击该组，并在上方菜单栏中点击添加，并选择需要添加的文件。
5. 耐心等待生成知识图谱完成，如果没有报错，则创建成功。
6. 在知识库界面左边树形控件中选择节点，并点击右键，弹出选择框后点击导入组、导出组按键可以。
### 4.3 管理知识图谱
1. 主界面点击知识库，选择子项知识库。
2. 在知识库界面左边树形控件中选择节点，并点击右键。
3. 弹出选择框后点击删除组、导入组、导出组可以实现知识组删除、导入、导出功能。
4. 选择默认节点，点击菜单栏“模板”可以导出点赞库，点击“导入”可导入点赞库。点击编辑、删除可以编辑和删除具体的点赞内容。
### 4.4 查看知识图谱
1. 知识图谱管理界面，选择知识库后，点击“知识图谱”按键。
2. 进入知识图谱查看界面后，点击相应的节点、边后点击查看按钮，可以查看对应数据。
3. 填入搜索内容，按下回车，显示相应搜索内容。
### 4.5 添加Excel文件
1. 选择“文件”菜单，点击“打开”，选择Excel文件。
2. 导入成功后，点击数据库，填入数据库名后，点击保存。（注意：Excel表的第一行自动识别为数据库表的字段名）
3. 点击刚才保存的数据库，再点击加载，可将数据库加载到当前表格中。
### 4.6 编辑数据库表
1. 打开Excel文件或加载数据库后，可以在“编辑”菜单中选择“复制、粘贴、撤销、恢复、添加列、添加行”相应功能。
2. 点击表格，右键可以选择相应功能。
3. 菜单栏中点击表项（例如sheet1）可以新建、删除、重命名数据库表项。
### 4.7 统计分析
1. 加载数据库后，主界面点击“统计分析”按钮，进入“数据库统计”页面。
2. 选择想要分析的数据库和表。
3. 选择要分析的字段后点击分析按钮，查看分析结果。点击导出可以导出分析结果。
### 4.8 Excel智能交互
1. 添加Excel文件并保存数据库后，加载此数据库。
2. 主界面右下方填入自然语言问题，点击“生成”按钮。
3. LLM处理后，自动弹出对话框，确认生成的SQL可行后，点击执行按钮，生成结果。（支持产生多个结果，例如：按月份生成十二个结果）
4. 点击导出，选择文件夹可以导出结果Excel表。点击“点赞”按钮可以将结果反馈给本地数据库（不会上传数据），帮助软件生成更准确结果。
### 4.9 AI对话
1. 选择“知识库”菜单，点击“对话”。
2. 不点击左边知识库树，在输入框中输入问题，点击“开始对话”按钮，等待结果生成。
3. 点击左边知识库树，会加载相应知识库，在输入框中输入问题，点击“开始对话”，等待结果生成。结果生成后，点击引用、历史可以查看相关内容。
### 4.10 API服务
* /api/SQL/List 获取数据库列表
* /api/SQL/Tables 获取指定数据库的表列表 参数：dbname
* /api/SQL/TableInfo 获取表结构和行数 参数：dbname,tablename
* /api/SQL/Get 分页获取表数据 参数：dbname,tablename,start,num
* /api/SQL/Chat SQL智能问答 参数：dbname,content
* /api/SQL/Do 执行SQL语句 参数：dbname,content
* /api/status 服务状态

## 5. 常见问题
### Q1: 启动时报错怎么办？
**A1:** 请检查 .NET 环境是否安装，或查看日志文件获取详细错误信息。
### Q2: Excel文件导入错误或者数据库创建错误怎么办？
**A2:** 请确保Excel文件第一行为数据库字段名，确保Excel数据格式正确，如数据库表的日期字段格式为“2025-12-30”。
### Q3: 模型加载报错怎么办？
**A3:** 首先确认模型地址是否正确，如果需要填入API密钥，是否填入了正确的API密钥。地址的http、https前缀等是否正确，网络是否正常等等。更换地址后可重启软件再进行测试。
### Q4: AI对话错误怎么办？
**A4:**
1. 确保模型地址、API密钥等是否正确。
2. 确保网络正常。
3. 如果是本地模型，确保模型服务正常。
4. 如果是在线模型，确保API密钥是否正确。
5. 确保令牌限制、每分钟调用次数限制等是否正确，不能太高也不能太低。

## 6. 联系与支持
如有问题或建议，请联系开发团队：
* 由于本人的代码就像生活一样糟糕，暂时不开源，请理解。
* 邮箱：deepersql@hotmail.com
