# DeeperSQL 軟體詳細教學
## 語言切換
[English](README.md)

## 教學目錄
* 1. 軟體簡介
* 2. 安裝與啟動
* 3. 主要功能
* 4. 操作步驟
* 5. 常見問題
* 6. 聯絡與支援

## 1. 軟體簡介
DeeperSQL 是一款整合 Excel 智慧互動、知識圖譜建構、AI 問答、資料視覺化等多功能的工具軟體，適用於資料編輯與分析、知識管理、智慧問答等多種情境。
* 匯入 Excel 檔案後，可透過自然語言處理並匯出。
* 內建圖表元件，可對資料進行視覺化分析
* 可透過大型語言模型建構知識圖譜，並進行智慧問答
* 跨平台支援 (Windows/macOS)

## 2. 安裝與啟動
### 2.1 系統需求
* 作業系統：Windows 10/11 或 macOS
* 相依套件：.NET 8.0 或更高版本
### 2.2 安裝步驟
1. 下載最新的安裝包。
2. 確保.NET組件支持，同時具備在線/離線大模型支持。(自帶嵌入式模型)。
3. 執行 `DeeperSQL` 主程式。
### 2.3 啟動軟體
1. 雙擊可執行檔。
2. 首次啟動請設定大型語言模型相關設定，以確保軟體正常運作。

## 3. 主要功能
### 3.1 Excel 智慧互動
匯入 Excel 檔案後，可將其儲存至資料庫中，並透過自然語言進行智慧處理、分析及匯出。
### 3.2 知識圖譜
支援知識圖譜的節點、關係、社群的自動產生、檢視、查詢，軟體透過大型語言模型自動產生知識圖譜。
### 3.3 AI 問答
AI 問答模組支援多種大型語言模型的接入，使用者可透過自然語言進行智慧問答，可選擇已產生的知識圖譜進行問答。
### 3.4 資料分析
匯入的 Excel 檔案存入資料庫後可進行資料分析、視覺化。
### 3.5 API 服務
對 SQL 智慧互動提供 API 服務。

## 4. 操作步驟
### 4.1 設定
1. 主介面點擊設定，然後選擇「Setting」。
2. 設定介面出現後，點擊 LLM 標籤頁，選擇常用的模型供應商，輸入 API 位址，若需要 API 金鑰則一併輸入，然後選擇對應的模型。
3. 輸入適當的每分鐘 API 呼叫次數限制和權杖限制。線上 API 的限制通常較低 (10-30)，權杖限制應至少為 4096，但通常小於 10240 (依實際情況調整)。
4. 然後輸入嵌入式模型的 API 位址和 API 金鑰，並選擇對應的模型。若本機模型使用 localhost 無反應，可嘗試使用 127.0.0.1。
5. 若模型載入時發生問題，將會彈出提示。請確保模型正確載入。
6. 若勾選「SQL 請求使用範例資料」，資料庫表格中的第一行資料將被用作範例資料。若涉及隱私或機密性問題，請使用本機 LLM 或取消勾選此選項。
7. 若勾選「使用原文索引」，將會增加權杖使用量，但能提高檢索準確性。
### 4.2 建立知識圖譜
1. 主介面點擊知識庫，然後選擇知識庫子項目。
2. 在知識庫介面左側的樹狀控制項中選擇一個節點，然後右鍵點擊。
3. 選單出現後，點擊新增群組，輸入群組名稱，然後點擊確認。
4. 新增完成後，在屬性控制項中點擊該群組，並在上方功能表中點擊新增，然後選擇要新增的檔案。
5. 耐心等待知識圖譜產生完成。若無錯誤發生，即表示建立成功。
6. 在知識庫介面左側的樹狀控制項中選擇一個節點，右鍵點擊，選單出現後，點擊匯入群組或匯出群組。
### 4.3 管理知識圖譜
1. 主介面點擊知識庫，然後選擇知識庫子項目。
2. 在知識庫介面左側的樹狀控制項中選擇一個節點，然後右鍵點擊。
3. 選單出現後，點擊刪除群組、匯入群組或匯出群組以執行這些功能。
4. 選擇預設節點，在功能表中點擊「範本」以匯出按讚資料庫，或點擊「匯入」以匯入。點擊編輯或刪除以修改或移除特定的按讚內容。
### 4.4 檢視知識圖譜
1. 在知識圖譜管理介面，選擇一個知識庫，然後點擊「知識圖譜」按鈕。
2. 進入知識圖譜檢視介面後，點擊相應的節點或邊，然後點擊檢視按鈕以查看對應資料。
3. 輸入搜尋內容，按下 Enter 鍵，相應的搜尋結果將會顯示。
### 4.5 新增 Excel 檔案
1. 選擇「檔案」選單，點擊「開啟」，然後選擇一個 Excel 檔案。
2. 成功匯入後，點擊資料庫，輸入資料庫名稱，然後點擊儲存。(注意：Excel 工作表的第一行會自動被辨識為資料庫表格的欄位名稱)
3. 點擊剛儲存的資料庫，然後點擊載入，將資料庫載入到目前的表格中。
### 4.6 編輯資料庫表格
1. 開啟 Excel 檔案或載入資料庫後，可在「編輯」選單中選擇「複製、貼上、復原、取消復原、新增欄、新增列」等功能。
2. 在表格上點擊並右鍵點擊以選擇相應功能。
3. 在功能表中點擊表格項目 (例如 sheet1) 以建立、刪除或重新命名資料庫表格項目。
### 4.7 統計分析
1. 載入資料庫後，在主介面點擊「統計」按鈕，進入「資料庫統計」頁面。
2. 選擇您想分析的資料庫和表格。
3. 選擇要分析的欄位，點擊分析按鈕，並檢視分析結果。點擊匯出以匯出分析結果。
### 4.8 Excel 智慧互動
1. 新增 Excel 檔案並儲存資料庫後，載入此資料庫。
2. 在主介面右下方輸入自然語言問題，然後點擊「產生」按鈕。
3. LLM 處理後，會自動彈出對話方塊。確認產生的 SQL 可行後，點擊執行以產生結果。(支援產生多個結果，例如：按月份產生十二個結果)
4. 點擊匯出並選擇一個資料夾，以將結果匯出為 Excel 表格。點擊「按讚」按鈕以向本機資料庫提供回饋 (資料不會上傳)，協助軟體產生更準確的結果。
### 4.9 AI 對話
1. 選擇「知識庫」選單，然後點擊「聊天」。
2. 不需點擊左側的知識庫樹，在輸入框中輸入問題，點擊「開始聊天」按鈕，然後等待結果產生。
3. 點擊左側的知識庫樹以載入相應的知識庫，在輸入框中輸入問題，點擊「開始聊天」，然後等待結果。結果產生後，點擊參考資料或歷史記錄以檢視相關內容。
### 4.10 API 服務
* /api/SQL/List 取得資料庫清單
* /api/SQL/Tables 取得指定資料庫的資料表清單 參數：dbname
* /api/SQL/TableInfo 取得資料表結構與資料列數 參數：dbname, tablename
* /api/SQL/Get 分頁取得資料表資料 參數：dbname, tablename, start, num
* /api/SQL/Chat SQL 智慧問答 參數：dbname, content
* /api/SQL/Do 執行 SQL 陳述式 參數：dbname, content
* /api/status 服務狀態

## 5. 常見問題
### Q1：啟動時發生錯誤怎麼辦？
**A1：** 請檢查 .NET 環境是否已安裝，或檢視日誌檔以取得詳細錯誤資訊。
### Q2：匯入 Excel 檔案或建立資料庫時發生錯誤怎麼辦？
**A2：** 請確保 Excel 檔案的第一行為資料庫欄位名稱，且 Excel 資料格式正確。例如，資料庫表格中的日期欄位應為 "2025-12-30" 格式。
### Q3：載入模型時發生錯誤怎麼辦？
**A3：** 首先，確認模型位址是否正確。若需要 API 金鑰，請確保已輸入正確的 API 金鑰。檢查 http/https 前置詞是否正確，網路是否正常等。變更位址後，重新啟動軟體進行測試。
### Q4：AI 對話發生錯誤怎麼辦？
**A4：**
1. 確保模型位址、API 金鑰等是否正確。
2. 確保網路正常。
3. 若為本機模型，請確保模型服務正常運作。
4. 若為線上模型，請確保 API 金鑰正確。
5. 確保權杖限制、每分鐘 API 呼叫限制等設定正確——不要太高也不要太低。

## 6. 聯絡與支援
若有任何問題或建議，請聯絡開發團隊：
* 由於本人的代碼就像生活一樣糟糕，暫時不開源，請理解。
* 電子郵件：deepersql@hotmail.com
